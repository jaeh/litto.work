'use strict';var draggableContainer=document.getElementsByClassName('draggables')[0],draggables=document.getElementsByClassName('drag'),maxZIndex=5*draggables.length,dragged=!1,startPos=!1,currentZIndex=1,forEach=function(a,b){for(var c=0;c<a.length;c++)a.hasOwnProperty(c)&&b(a[c])},onload=function(a){return function(b){var c=Math.floor;if(cl.has(b.target,'bg')){var d=b.target,e=d.naturalWidth,f=d.naturalHeight,g=0,h=0,i=.7*window.innerWidth;// resize if too wide
if(e>i){var l=e/i+.1;e/=l,f/=l}// resize if too high
var m=.7*window.innerHeight;if(f>m){var n=f/m+.1;f/=n,e/=n}var j=window.innerWidth-e,k=window.innerHeight-f;g=Math.random()*j,h=Math.random()*k,g=c(percentFromPixels('Width',g))+'%',h=c(percentFromPixels('Height',h))+'%',a.style.left=g,a.style.top=h}}};// global app state
// resize and reposition after load of images
forEach(draggables,function(a){var b=Math.random(),c={left:'100%',top:'100%'};.7<b?c.left='-'+c.left:.3>b&&(c.top='-'+c.top),a.style.left=c.left,a.style.top=c.top;var d=a.getElementsByClassName('bg')[0];d&&d.addEventListener('load',onload(a))});var cl={has:function c(a,b){return a.className&&-1<a.className.indexOf(b)},add:function c(a,b){cl.has(a,b)||(a.className=a.className?a.className+' '+b:b)},rm:function c(a,b){cl.has(a,b)&&(a.className=a.className.replace(b,'').trim())},toggle:function c(a,b){cl.has(a,b)?cl.rm(a,b):cl.add(a,b)}},doNothing=function(a){return a.preventDefault(),!1},$=function(a){return document.getElementById(a)},getPos=function(a){return parseInt(a.replace('%',''))},percentFromPixels=function(a,b){return 100*(b/window['inner'+a])},pixelsFromPercent=function(a,b){return b*window['inner'+a]/100},isOutOfBounds=function(a){return a.clientX>=window.innerWidth||0>=a.clientX||a.clientY>=window.innerHeight||0>=a.clientY},drag=function(a){dragged=a.currentTarget,cl.add(dragged,'dragged'),startPos={left:pixelsFromPercent('Width',getPos(dragged.style.left)),top:pixelsFromPercent('Height',getPos(dragged.style.top))},currentZIndex+=1,dragged.style.zIndex=currentZIndex,dragged.offset={left:a.clientX-pixelsFromPercent('Width',getPos(dragged.style.left)),top:a.clientY-pixelsFromPercent('Height',getPos(dragged.style.top))},dragged.style.opacity=.8,document.addEventListener('mousemove',mousemove),document.addEventListener('mouseup',drop),document.addEventListener('mouseout',dropIfOutOfBounds)},drop=function(){dragged&&(forEach(draggables,function(a){cl.rm(a,'dropped'),cl.rm(a,'dragged')}),cl.add(dragged,'dropped'),dragged.style.opacity=1,document.removeEventListener('mousemove',mousemove),document.removeEventListener('mouseup',drop),document.removeEventListener('mouseout',dropIfOutOfBounds),dragged=!1,startPos=!1)},dropIfOutOfBounds=function(a){isOutOfBounds(a)&&drop(a)},mousemove=function(a){if(dragged){var b={left:window.innerWidth-dragged.clientWidth,top:window.innerHeight-dragged.clientHeight},c=a.clientX-dragged.offset.left;0>c?c=0:c>b.left&&(c=b.left),dragged.style.left=percentFromPixels('Width',c)+'%';var d=a.clientY-dragged.offset.top;0>d?d=0:d>b.top&&(d=b.top),dragged.style.top=percentFromPixels('Height',d)+'%'}},makeDraggable=function(a){a.addEventListener('dragstart',doNothing),a.addEventListener('mousedown',drag),a.addEventListener('touchstart',function(a){a.stopPropagation(),drag(a)})};forEach(draggables,makeDraggable);// Menu
var menuContainer=document.getElementsByClassName('nav')[0],active=menuContainer.getElementsByClassName('active')[0],toggleMenu=function(a){return a.preventDefault(),cl.toggle(menuContainer,'show'),!1};active&&(active.addEventListener('click',toggleMenu),active.addEventListener('touchstart',function(a){a.stopPropagation(),toggleMenu(a)}));