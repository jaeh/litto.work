'use strict';var draggableContainer=document.getElementsByClassName('draggables')[0],draggables=document.getElementsByClassName('drag'),maxZIndex=5*draggables.length,dragged=!1,startPos=!1,currentZIndex=1,forEach=function(a,b){for(var c=0;c<a.length;c++)a.hasOwnProperty(c)&&b(a[c])},onload=function(a){return function(b){var c=Math.floor;if(cl.has(b.target,'bg')){var d=b.target,e=d.naturalWidth,f=d.naturalHeight,g=0,h=0,i=.7*window.innerWidth;// resize if too wide
if(e>i){var l=e/i+.1;e/=l,f/=l}// resize if too high
var m=.7*window.innerHeight;if(f>m){var n=f/m+.1;f/=n,e/=n}a.style.height=f+'px',a.style.width=e+'px';var j=window.innerWidth-e,k=window.innerHeight-f;g=Math.random()*j,h=Math.random()*k,g=c(percentFromPixels('Width',g))+'%',h=c(percentFromPixels('Height',h))+'%',a.style.left=g,a.style.top=h}}};// global app state
// resize and reposition after load of images
forEach(draggables,function(a){var b=Math.random(),c={left:'100%',top:'100%'};.7<b?c.left='-'+c.left:.3>b&&(c.top='-'+c.top),a.style.left=c.left,a.style.top=c.top;var d=a.getElementsByClassName('bg')[0];d&&d.addEventListener('load',onload(a))});var cl={has:function c(a,b){return a.className&&-1<a.className.indexOf(b)},add:function c(a,b){cl.has(a,b)||(a.className=a.className?a.className+' '+b:b)},rm:function c(a,b){cl.has(a,b)&&(a.className=a.className.replace(b,'').trim())},toggle:function c(a,b){cl.has(a,b)?cl.rm(a,b):cl.add(a,b)}},doNothing=function(a){return a.preventDefault(),!1},$=function(a){return document.getElementById(a)},getPos=function(a){return parseInt(a.replace('%',''))},percentFromPixels=function(a,b){return 100*(b/window['inner'+a])},pixelsFromPercent=function(a,b){return b*window['inner'+a]/100},isOutOfBounds=function(a){return a.clientX>=window.innerWidth||0>=a.clientX||a.clientY>=window.innerHeight||0>=a.clientY},drag=function(a){dragged=a.currentTarget,cl.add(dragged,'dragged'),startPos={left:pixelsFromPercent('Width',getPos(dragged.style.left)),top:pixelsFromPercent('Height',getPos(dragged.style.top))},currentZIndex+=1,dragged.style.zIndex=currentZIndex,dragged.offset={left:a.clientX-pixelsFromPercent('Width',getPos(dragged.style.left)),top:a.clientY-pixelsFromPercent('Height',getPos(dragged.style.top))},dragged.style.opacity=.8,document.addEventListener('mousemove',mousemove),document.addEventListener('mouseup',drop),document.addEventListener('mouseout',dropIfOutOfBounds)},drop=function(){dragged&&(forEach(draggables,function(a){cl.rm(a,'dropped'),cl.rm(a,'dragged')}),cl.add(dragged,'dropped'),dragged.style.opacity=1,document.removeEventListener('mousemove',mousemove),document.removeEventListener('mouseup',drop),document.removeEventListener('mouseout',dropIfOutOfBounds),dragged=!1,startPos=!1)},dropIfOutOfBounds=function(a){isOutOfBounds(a)&&drop(a)},mousemove=function(a){if(dragged){var b={left:window.innerWidth-dragged.clientWidth,top:window.innerHeight-dragged.clientHeight},c=a.clientX-dragged.offset.left;0>c?c=0:c>b.left&&(c=b.left),dragged.style.left=percentFromPixels('Width',c)+'%';var d=a.clientY-dragged.offset.top;0>d?d=0:d>b.top&&(d=b.top),dragged.style.top=percentFromPixels('Height',d)+'%'}},makeDraggable=function(a){a.addEventListener('dragstart',doNothing),a.addEventListener('mousedown',drag),a.addEventListener('touchstart',function(a){a.stopPropagation(),drag(a)})};forEach(draggables,makeDraggable);// Menu
var menuContainer=document.getElementsByClassName('nav')[0],active=menuContainer.getElementsByClassName('active')[0],toggleMenu=function(a){return a.preventDefault(),cl.toggle(menuContainer,'show'),!1};active&&(active.addEventListener('click',toggleMenu),active.addEventListener('touchstart',function(a){a.stopPropagation(),toggleMenu(a)}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImRyYWdnYWJsZUNvbnRhaW5lciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImRyYWdnYWJsZXMiLCJtYXhaSW5kZXgiLCJsZW5ndGgiLCJkcmFnZ2VkIiwic3RhcnRQb3MiLCJjdXJyZW50WkluZGV4IiwiZm9yRWFjaCIsIml0ZW1zIiwiZm4iLCJpIiwiaGFzT3duUHJvcGVydHkiLCJvbmxvYWQiLCJNYXRoIiwiZmxvb3IiLCJjbCIsImhhcyIsImUiLCJ0YXJnZXQiLCJ0YXIiLCJ3aWR0aCIsIm5hdHVyYWxXaWR0aCIsImhlaWdodCIsIm5hdHVyYWxIZWlnaHQiLCJsZWZ0IiwidG9wIiwibWF4V2lkdGgiLCJpbm5lcldpZHRoIiwid2lkdGhQZXJjZW50IiwibWF4SGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJoZWlnaHRQZXJjZW50IiwicGFyIiwic3R5bGUiLCJtYXhMZWZ0Iiwid2luZG93IiwibWF4VG9wIiwicmFuZG9tIiwicGVyY2VudEZyb21QaXhlbHMiLCJyYW4iLCJwb3MiLCJkIiwiaW1nIiwiYWRkRXZlbnRMaXN0ZW5lciIsImMiLCJjbGFzc05hbWUiLCJpbmRleE9mIiwiYWRkIiwicm0iLCJyZXBsYWNlIiwidHJpbSIsInRvZ2dsZSIsImRvTm90aGluZyIsInByZXZlbnREZWZhdWx0IiwiJCIsImdldEVsZW1lbnRCeUlkIiwic3RyIiwiZ2V0UG9zIiwicGFyc2VJbnQiLCJkaXJlY3Rpb24iLCJweCIsInBpeGVsc0Zyb21QZXJjZW50IiwicGMiLCJpc091dE9mQm91bmRzIiwiY2xpZW50WCIsImNsaWVudFkiLCJkcmFnIiwiZXYiLCJjdXJyZW50VGFyZ2V0IiwiekluZGV4Iiwib2Zmc2V0Iiwib3BhY2l0eSIsIm1vdXNlbW92ZSIsImRyb3AiLCJkcm9wSWZPdXRPZkJvdW5kcyIsImVsZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtYXgiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsIm5ld0xlZnQiLCJuZXdUb3AiLCJtYWtlRHJhZ2dhYmxlIiwic3RvcFByb3BhZ2F0aW9uIiwibWVudUNvbnRhaW5lciIsImFjdGl2ZSIsInRvZ2dsZU1lbnUiXSwibWFwcGluZ3MiOiJnQkFBTUEsb0JBQXFCQyxTQUFTQyxzQkFBVCxDQUFnQyxZQUFoQyxFQUE4QyxDQUE5QyxDLENBQ3JCQyxXQUFhRixTQUFTQyxzQkFBVCxDQUFnQyxNQUFoQyxDLENBQ2JFLFVBQWdDLENBQXBCLFlBQVdDLE0sQ0FHekJDLFUsQ0FDQUMsVyxDQUNBQyxjQUFnQixDLENBRWRDLFFBQVUsU0FBQ0MsQ0FBRCxDQUFRQyxDQUFSLENBQWUsQ0FDN0IsSUFBSyxHQUFJQyxHQUFJLENBQWIsQ0FBZ0JBLEVBQUlGLEVBQU1MLE1BQTFCLENBQWtDTyxHQUFsQyxDQUNNRixFQUFNRyxjQUFOLENBQXFCRCxDQUFyQixDQUROLEVBRUlELEVBQUdELEVBQU1FLENBQU4sQ0FBSCxDQUdMLEMsQ0FJS0UsT0FBUyxrQkFBTyxZQUFLLE9BK0JiQyxLQUFLQyxLQS9CUSxDQUN6QixHQUFJQyxHQUFHQyxHQUFILENBQU9DLEVBQUVDLE1BQVQsQ0FBaUIsSUFBakIsQ0FBSixDQUE0QixJQUNwQkMsR0FBTUYsRUFBRUMsTUFEWSxDQUV0QkUsRUFBUUQsRUFBSUUsWUFGVSxDQUd0QkMsRUFBU0gsRUFBSUksYUFIUyxDQUl0QkMsRUFBTyxDQUplLENBS3RCQyxFQUFNLENBTGdCLENBUXBCQyxFQUErQixFQUFwQixRQUFPQyxVQVJFLENBTzFCO0FBRUEsR0FBSVAsRUFBUU0sQ0FBWixDQUFzQixDQUNwQixHQUFNRSxHQUFnQlIsRUFBUU0sQ0FBVCxDQUFxQixFQUExQyxDQUNBTixHQUFTUSxDQUZXLENBR3BCTixHQUFVTSxDQUNYLENBRUQ7QUFDQSxHQUFNQyxHQUFpQyxFQUFyQixRQUFPQyxXQUF6QixDQUNBLEdBQUlSLEVBQVNPLENBQWIsQ0FBd0IsQ0FDdEIsR0FBTUUsR0FBaUJULEVBQVNPLENBQVYsQ0FBdUIsRUFBN0MsQ0FDQVAsR0FBVVMsQ0FGWSxDQUd0QlgsR0FBU1csQ0FDVixDQUVEQyxFQUFJQyxLQUFKLENBQVVYLE1BQVYsQ0FBc0JBLENBQXRCLEtBdkIwQixDQXdCMUJVLEVBQUlDLEtBQUosQ0FBVWIsS0FBVixDQUFxQkEsQ0FBckIsS0F4QjBCLElBMEJwQmMsR0FBVUMsT0FBT1IsVUFBUCxDQUFvQlAsQ0ExQlYsQ0EyQnBCZ0IsRUFBU0QsT0FBT0wsV0FBUCxDQUFxQlIsQ0EzQlYsQ0E0QjFCRSxFQUFPWCxLQUFLd0IsTUFBTCxHQUFnQkgsQ0E1QkcsQ0E2QjFCVCxFQUFNWixLQUFLd0IsTUFBTCxHQUFnQkQsQ0E3QkksQ0E4QjFCWixFQUFVLEVBQVdjLGtCQUFrQixPQUFsQixDQUEyQmQsQ0FBM0IsQ0FBWCxDQUFWLElBOUIwQixDQStCMUJDLEVBQVMsRUFBV2Esa0JBQWtCLFFBQWxCLENBQTRCYixDQUE1QixDQUFYLENBQVQsSUEvQjBCLENBaUMxQk8sRUFBSUMsS0FBSixDQUFVVCxJQUFWLENBQWlCQSxDQWpDUyxDQWtDMUJRLEVBQUlDLEtBQUosQ0FBVVIsR0FBVixDQUFnQkEsQ0FDakIsQ0FDRixDQXJDYyxDLENBZmY7QUFhQTtBQXlDQWxCLFFBQVFOLFVBQVIsQ0FBb0IsV0FBSyxJQUNqQnNDLEdBQU0xQixLQUFLd0IsTUFBTCxFQURXLENBRWpCRyxFQUFNLENBQ1ZoQixLQUFNLE1BREksQ0FFVkMsSUFBSyxNQUZLLENBRlcsQ0FPYixFQUFOLEVBUG1CLENBUXJCZSxFQUFJaEIsSUFBSixLQUFlZ0IsRUFBSWhCLElBUkUsQ0FTTixFQUFOLEVBVFksR0FVckJnQixFQUFJZixHQUFKLEtBQWNlLEVBQUlmLEdBVkcsRUFhdkJnQixFQUFFUixLQUFGLENBQVFULElBQVIsQ0FBZWdCLEVBQUloQixJQWJJLENBY3ZCaUIsRUFBRVIsS0FBRixDQUFRUixHQUFSLENBQWNlLEVBQUlmLEdBZEssQ0FnQnZCLEdBQU1pQixHQUFNRCxFQUFFekMsc0JBQUYsQ0FBeUIsSUFBekIsRUFBK0IsQ0FBL0IsQ0FBWixDQUNJMEMsQ0FqQm1CLEVBa0JyQkEsRUFBSUMsZ0JBQUosQ0FBcUIsTUFBckIsQ0FBNkIvQixPQUFPNkIsQ0FBUCxDQUE3QixDQUVILENBcEJELEMsSUFzQk0xQixJQUFLLENBQ1RDLEdBRFMsWUFDTEMsQ0FESyxDQUNGMkIsQ0FERSxDQUNDLENBQ1IsTUFBTzNCLEdBQUU0QixTQUFGLEVBQXdDLENBQUMsQ0FBMUIsR0FBRUEsU0FBRixDQUFZQyxPQUFaLENBQW9CRixDQUFwQixDQUN2QixDQUhRLENBSVRHLEdBSlMsWUFJTDlCLENBSkssQ0FJRjJCLENBSkUsQ0FJQyxDQUNIN0IsR0FBR0MsR0FBSCxDQUFPQyxDQUFQLENBQVUyQixDQUFWLENBREcsR0FFTjNCLEVBQUU0QixTQUFGLENBQWM1QixFQUFFNEIsU0FBRixDQUFjNUIsRUFBRTRCLFNBQUYsQ0FBYyxHQUFkLENBQW9CRCxDQUFsQyxDQUFzQ0EsQ0FGOUMsQ0FJVCxDQVJRLENBU1RJLEVBVFMsWUFTTi9CLENBVE0sQ0FTSDJCLENBVEcsQ0FTQSxDQUNIN0IsR0FBR0MsR0FBSCxDQUFPQyxDQUFQLENBQVUyQixDQUFWLENBREcsR0FFTDNCLEVBQUU0QixTQUFGLENBQWM1QixFQUFFNEIsU0FBRixDQUFZSSxPQUFaLENBQW9CTCxDQUFwQixDQUF1QixFQUF2QixFQUEyQk0sSUFBM0IsRUFGVCxDQUlSLENBYlEsQ0FjVEMsT0FBUSxXQUFDbEMsQ0FBRCxDQUFJMkIsQ0FBSixDQUFVLENBQ1o3QixHQUFHQyxHQUFILENBQU9DLENBQVAsQ0FBVTJCLENBQVYsQ0FEWSxDQUVkN0IsR0FBR2lDLEVBQUgsQ0FBTS9CLENBQU4sQ0FBUzJCLENBQVQsQ0FGYyxDQUlkN0IsR0FBR2dDLEdBQUgsQ0FBTzlCLENBQVAsQ0FBVTJCLENBQVYsQ0FFSCxDQXBCUSxDLENBdUJMUSxVQUFZLFNBQUNuQyxDQUFELENBQU8sQ0FFdkIsTUFEQUEsR0FBRW9DLGNBQUYsRUFDQSxHQUNELEMsQ0FFS0MsRUFBSSxrQkFBT3ZELFVBQVN3RCxjQUFULENBQXdCQyxDQUF4QixDQUFQLEMsQ0FFSkMsT0FBUyxrQkFBS0MsVUFBU3pDLEVBQUVnQyxPQUFGLENBQVUsR0FBVixDQUFlLEVBQWYsQ0FBVCxDQUFMLEMsQ0FFVFgsa0JBQW9CLFNBQUNxQixDQUFELENBQVlDLENBQVosUUFBd0QsSUFBckMsRUFBQ0EsRUFBS3pCLGVBQWV3QixDQUFmLENBQU4sQ0FBbkIsQyxDQUNwQkUsa0JBQW9CLFNBQUNGLENBQUQsQ0FBWUcsQ0FBWixRQUFvQkEsR0FBSzNCLGVBQWV3QixDQUFmLENBQU4sQ0FBcUMsR0FBeEQsQyxDQUVwQkksY0FBZ0Isa0JBQ3BCOUMsR0FBRStDLE9BQUYsRUFBYTdCLE9BQU9SLFVBQXBCLEVBQ2EsQ0FBYixJQUFFcUMsT0FERixFQUVBL0MsRUFBRWdELE9BQUYsRUFBYTlCLE9BQU9MLFdBRnBCLEVBR2EsQ0FBYixJQUFFbUMsT0FKa0IsQyxDQU9oQkMsS0FBTyxXQUFNLENBQ2pCOUQsUUFBVStELEVBQUdDLGFBREksQ0FHakJyRCxHQUFHZ0MsR0FBSCxDQUFPM0MsT0FBUCxDQUFnQixTQUFoQixDQUhpQixDQUtqQkMsU0FBVyxDQUNUbUIsS0FBTXFDLGtCQUFrQixPQUFsQixDQUEyQkosT0FBT3JELFFBQVE2QixLQUFSLENBQWNULElBQXJCLENBQTNCLENBREcsQ0FFVEMsSUFBS29DLGtCQUFrQixRQUFsQixDQUE0QkosT0FBT3JELFFBQVE2QixLQUFSLENBQWNSLEdBQXJCLENBQTVCLENBRkksQ0FMTSxDQVNqQm5CLGVBQWlCLENBVEEsQ0FVakJGLFFBQVE2QixLQUFSLENBQWNvQyxNQUFkLENBQXVCL0QsYUFWTixDQVdqQkYsUUFBUWtFLE1BQVIsQ0FBaUIsQ0FDZjlDLEtBQU0yQyxFQUFHSCxPQUFILENBQWFILGtCQUFrQixPQUFsQixDQUEyQkosT0FBT3JELFFBQVE2QixLQUFSLENBQWNULElBQXJCLENBQTNCLENBREosQ0FFZkMsSUFBSzBDLEVBQUdGLE9BQUgsQ0FBYUosa0JBQWtCLFFBQWxCLENBQTRCSixPQUFPckQsUUFBUTZCLEtBQVIsQ0FBY1IsR0FBckIsQ0FBNUIsQ0FGSCxDQVhBLENBZWpCckIsUUFBUTZCLEtBQVIsQ0FBY3NDLE9BQWQsQ0FBd0IsRUFmUCxDQWlCakJ4RSxTQUFTNEMsZ0JBQVQsQ0FBMEIsV0FBMUIsQ0FBdUM2QixTQUF2QyxDQWpCaUIsQ0FrQmpCekUsU0FBUzRDLGdCQUFULENBQTBCLFNBQTFCLENBQXFDOEIsSUFBckMsQ0FsQmlCLENBbUJqQjFFLFNBQVM0QyxnQkFBVCxDQUEwQixVQUExQixDQUFzQytCLGlCQUF0QyxDQUNELEMsQ0FFS0QsS0FBTyxVQUFNLENBQ1pyRSxPQURZLEdBS2pCRyxRQUFRTixVQUFSLENBQW9CLFNBQVMwRSxDQUFULENBQWMsQ0FDaEM1RCxHQUFHaUMsRUFBSCxDQUFNMkIsQ0FBTixDQUFXLFNBQVgsQ0FEZ0MsQ0FFaEM1RCxHQUFHaUMsRUFBSCxDQUFNMkIsQ0FBTixDQUFXLFNBQVgsQ0FDRCxDQUhELENBTGlCLENBU2pCNUQsR0FBR2dDLEdBQUgsQ0FBTzNDLE9BQVAsQ0FBZ0IsU0FBaEIsQ0FUaUIsQ0FXakJBLFFBQVE2QixLQUFSLENBQWNzQyxPQUFkLENBQXdCLENBWFAsQ0FjakJ4RSxTQUFTNkUsbUJBQVQsQ0FBNkIsV0FBN0IsQ0FBMENKLFNBQTFDLENBZGlCLENBZWpCekUsU0FBUzZFLG1CQUFULENBQTZCLFNBQTdCLENBQXdDSCxJQUF4QyxDQWZpQixDQWdCakIxRSxTQUFTNkUsbUJBQVQsQ0FBNkIsVUFBN0IsQ0FBeUNGLGlCQUF6QyxDQWhCaUIsQ0FrQmpCdEUsVUFsQmlCLENBbUJqQkMsV0FuQmlCLENBb0JsQixDLENBRUtxRSxrQkFBb0IsV0FBSyxDQUN6QlgsY0FBYzlDLENBQWQsQ0FEeUIsRUFFM0J3RCxLQUFLeEQsQ0FBTCxDQUVILEMsQ0FFS3VELFVBQVksV0FBTSxDQUN0QixHQUFJcEUsT0FBSixDQUFhLElBQ0x5RSxHQUFNLENBQ1ZyRCxLQUFNVyxPQUFPUixVQUFQLENBQW9CdkIsUUFBUTBFLFdBRHhCLENBRVZyRCxJQUFLVSxPQUFPTCxXQUFQLENBQXFCMUIsUUFBUTJFLFlBRnhCLENBREQsQ0FNUEMsRUFBVWIsRUFBR0gsT0FBSCxDQUFhNUQsUUFBUWtFLE1BQVIsQ0FBZTlDLElBTi9CLENBT0csQ0FBVixFQVBPLENBUVR3RCxFQUFVLENBUkQsQ0FTQUEsRUFBVUgsRUFBSXJELElBVGQsR0FVVHdELEVBQVVILEVBQUlyRCxJQVZMLEVBYVhwQixRQUFRNkIsS0FBUixDQUFjVCxJQUFkLENBQXdCYyxrQkFBa0IsT0FBbEIsQ0FBMkIwQyxDQUEzQixDQUF4QixJQWJXLENBZVgsR0FBSUMsR0FBU2QsRUFBR0YsT0FBSCxDQUFhN0QsUUFBUWtFLE1BQVIsQ0FBZTdDLEdBQXpDLENBQ2EsQ0FBVCxFQWhCTyxDQWlCVHdELEVBQVMsQ0FqQkEsQ0FrQkFBLEVBQVNKLEVBQUlwRCxHQWxCYixHQW1CVHdELEVBQVNKLEVBQUlwRCxHQW5CSixFQXFCWHJCLFFBQVE2QixLQUFSLENBQWNSLEdBQWQsQ0FBdUJhLGtCQUFrQixRQUFsQixDQUE0QjJDLENBQTVCLENBQXZCLElBQ0QsQ0FDRixDLENBRUtDLGNBQWdCLFNBQUNQLENBQUQsQ0FBUyxDQUM3QkEsRUFBSWhDLGdCQUFKLENBQXFCLFdBQXJCLENBQWtDUyxTQUFsQyxDQUQ2QixDQUU3QnVCLEVBQUloQyxnQkFBSixDQUFxQixXQUFyQixDQUFrQ3VCLElBQWxDLENBRjZCLENBRzdCUyxFQUFJaEMsZ0JBQUosQ0FBcUIsWUFBckIsQ0FBbUMsV0FBSyxDQUN0QzFCLEVBQUVrRSxlQUFGLEVBRHNDLENBRXRDakIsS0FBS2pELENBQUwsQ0FDRCxDQUhELENBSUQsQyxDQUVEVixRQUFRTixVQUFSLENBQW9CaUYsYUFBcEIsQyxDQUVBO0dBQ01FLGVBQWdCckYsU0FBU0Msc0JBQVQsQ0FBZ0MsS0FBaEMsRUFBdUMsQ0FBdkMsQyxDQUNoQnFGLE9BQVNELGNBQWNwRixzQkFBZCxDQUFxQyxRQUFyQyxFQUErQyxDQUEvQyxDLENBRVRzRixXQUFhLFdBQUssQ0FHdEIsTUFGQXJFLEdBQUVvQyxjQUFGLEVBRUEsQ0FEQXRDLEdBQUdvQyxNQUFILENBQVVpQyxhQUFWLENBQXlCLE1BQXpCLENBQ0EsR0FDRCxDLENBRUdDLE0sR0FDRkEsT0FBTzFDLGdCQUFQLENBQXdCLE9BQXhCLENBQWlDMkMsVUFBakMsQyxDQUNBRCxPQUFPMUMsZ0JBQVAsQ0FBd0IsWUFBeEIsQ0FBc0MsV0FBSyxDQUN6QzFCLEVBQUVrRSxlQUFGLEVBRHlDLENBRXpDRyxXQUFXckUsQ0FBWCxDQUNELENBSEQsQyIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGRyYWdnYWJsZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2RyYWdnYWJsZXMnKVswXVxuY29uc3QgZHJhZ2dhYmxlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2RyYWcnKVxuY29uc3QgbWF4WkluZGV4ID0gZHJhZ2dhYmxlcy5sZW5ndGggKiA1XG5cbi8vIGdsb2JhbCBhcHAgc3RhdGVcbmxldCBkcmFnZ2VkID0gZmFsc2VcbmxldCBzdGFydFBvcyA9IGZhbHNlXG5sZXQgY3VycmVudFpJbmRleCA9IDFcblxuY29uc3QgZm9yRWFjaCA9IChpdGVtcywgZm4pID0+IHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChpdGVtcy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgZm4oaXRlbXNbaV0pXG4gICAgfVxuICB9XG59XG5cbi8vIHJlc2l6ZSBhbmQgcmVwb3NpdGlvbiBhZnRlciBsb2FkIG9mIGltYWdlc1xuXG5jb25zdCBvbmxvYWQgPSBwYXIgPT4gZSA9PiB7XG4gIGlmIChjbC5oYXMoZS50YXJnZXQsICdiZycpKSB7XG4gICAgY29uc3QgdGFyID0gZS50YXJnZXRcbiAgICBsZXQgd2lkdGggPSB0YXIubmF0dXJhbFdpZHRoXG4gICAgbGV0IGhlaWdodCA9IHRhci5uYXR1cmFsSGVpZ2h0XG4gICAgbGV0IGxlZnQgPSAwXG4gICAgbGV0IHRvcCA9IDBcblxuICAgIC8vIHJlc2l6ZSBpZiB0b28gd2lkZVxuICAgIGNvbnN0IG1heFdpZHRoID0gd2luZG93LmlubmVyV2lkdGggKiAuN1xuICAgIGlmICh3aWR0aCA+IG1heFdpZHRoKSB7XG4gICAgICBjb25zdCB3aWR0aFBlcmNlbnQgPSAod2lkdGggLyBtYXhXaWR0aCkgKyAuMVxuICAgICAgd2lkdGggLz0gd2lkdGhQZXJjZW50XG4gICAgICBoZWlnaHQgLz0gd2lkdGhQZXJjZW50XG4gICAgfVxuXG4gICAgLy8gcmVzaXplIGlmIHRvbyBoaWdoXG4gICAgY29uc3QgbWF4SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0ICogLjdcbiAgICBpZiAoaGVpZ2h0ID4gbWF4SGVpZ2h0KSB7XG4gICAgICBjb25zdCBoZWlnaHRQZXJjZW50ID0gKGhlaWdodCAvIG1heEhlaWdodCkgKyAuMVxuICAgICAgaGVpZ2h0IC89IGhlaWdodFBlcmNlbnRcbiAgICAgIHdpZHRoIC89IGhlaWdodFBlcmNlbnRcbiAgICB9XG5cbiAgICBwYXIuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YFxuICAgIHBhci5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YFxuXG4gICAgY29uc3QgbWF4TGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gd2lkdGhcbiAgICBjb25zdCBtYXhUb3AgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBoZWlnaHRcbiAgICBsZWZ0ID0gTWF0aC5yYW5kb20oKSAqIG1heExlZnRcbiAgICB0b3AgPSBNYXRoLnJhbmRvbSgpICogbWF4VG9wXG4gICAgbGVmdCA9IGAke01hdGguZmxvb3IocGVyY2VudEZyb21QaXhlbHMoJ1dpZHRoJywgbGVmdCkpfSVgXG4gICAgdG9wID0gYCR7TWF0aC5mbG9vcihwZXJjZW50RnJvbVBpeGVscygnSGVpZ2h0JywgdG9wKSl9JWBcblxuICAgIHBhci5zdHlsZS5sZWZ0ID0gbGVmdFxuICAgIHBhci5zdHlsZS50b3AgPSB0b3BcbiAgfVxufVxuXG5mb3JFYWNoKGRyYWdnYWJsZXMsIGQgPT4ge1xuICBjb25zdCByYW4gPSBNYXRoLnJhbmRvbSgpXG4gIGNvbnN0IHBvcyA9IHtcbiAgICBsZWZ0OiAnMTAwJScsXG4gICAgdG9wOiAnMTAwJScsXG4gIH1cblxuICBpZiAocmFuID4gMC43KSB7XG4gICAgcG9zLmxlZnQgPSBgLSR7cG9zLmxlZnR9YFxuICB9IGVsc2UgaWYgKHJhbiA8IDAuMykge1xuICAgIHBvcy50b3AgPSBgLSR7cG9zLnRvcH1gXG4gIH1cblxuICBkLnN0eWxlLmxlZnQgPSBwb3MubGVmdFxuICBkLnN0eWxlLnRvcCA9IHBvcy50b3BcblxuICBjb25zdCBpbWcgPSBkLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JnJylbMF1cbiAgaWYgKGltZykge1xuICAgIGltZy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgb25sb2FkKGQpKVxuICB9XG59KVxuXG5jb25zdCBjbCA9IHtcbiAgaGFzKGUsIGMpIHtcbiAgICByZXR1cm4gZS5jbGFzc05hbWUgJiYgZS5jbGFzc05hbWUuaW5kZXhPZihjKSA+IC0xXG4gIH0sXG4gIGFkZChlLCBjKSB7XG4gICAgaWYgKCFjbC5oYXMoZSwgYykpIHtcbiAgICAgIGUuY2xhc3NOYW1lID0gZS5jbGFzc05hbWUgPyBlLmNsYXNzTmFtZSArICcgJyArIGMgOiBjXG4gICAgfVxuICB9LFxuICBybShlLCBjKSB7XG4gICAgaWYgKGNsLmhhcyhlLCBjKSkge1xuICAgICAgZS5jbGFzc05hbWUgPSBlLmNsYXNzTmFtZS5yZXBsYWNlKGMsICcnKS50cmltKClcbiAgICB9XG4gIH0sXG4gIHRvZ2dsZTogKGUsIGMpID0+IHtcbiAgICBpZiAoY2wuaGFzKGUsIGMpKSB7XG4gICAgICBjbC5ybShlLCBjKVxuICAgIH0gZWxzZSB7XG4gICAgICBjbC5hZGQoZSwgYylcbiAgICB9XG4gIH0sXG59XG5cbmNvbnN0IGRvTm90aGluZyA9IChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKVxuICByZXR1cm4gZmFsc2Vcbn1cblxuY29uc3QgJCA9IHN0ciA9PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdHIpXG5cbmNvbnN0IGdldFBvcyA9IGUgPT4gcGFyc2VJbnQoZS5yZXBsYWNlKCclJywgJycpKVxuXG5jb25zdCBwZXJjZW50RnJvbVBpeGVscyA9IChkaXJlY3Rpb24sIHB4KSA9PiAocHggLyB3aW5kb3dbYGlubmVyJHtkaXJlY3Rpb259YF0pICogMTAwXG5jb25zdCBwaXhlbHNGcm9tUGVyY2VudCA9IChkaXJlY3Rpb24sIHBjKSA9PiAocGMgKiB3aW5kb3dbYGlubmVyJHtkaXJlY3Rpb259YF0pIC8gMTAwXG5cbmNvbnN0IGlzT3V0T2ZCb3VuZHMgPSBlID0+IChcbiAgZS5jbGllbnRYID49IHdpbmRvdy5pbm5lcldpZHRoIHx8XG4gIGUuY2xpZW50WCA8PSAwIHx8XG4gIGUuY2xpZW50WSA+PSB3aW5kb3cuaW5uZXJIZWlnaHQgfHxcbiAgZS5jbGllbnRZIDw9IDBcbilcblxuY29uc3QgZHJhZyA9IGV2ID0+IHtcbiAgZHJhZ2dlZCA9IGV2LmN1cnJlbnRUYXJnZXRcblxuICBjbC5hZGQoZHJhZ2dlZCwgJ2RyYWdnZWQnKVxuXG4gIHN0YXJ0UG9zID0ge1xuICAgIGxlZnQ6IHBpeGVsc0Zyb21QZXJjZW50KCdXaWR0aCcsIGdldFBvcyhkcmFnZ2VkLnN0eWxlLmxlZnQpKSxcbiAgICB0b3A6IHBpeGVsc0Zyb21QZXJjZW50KCdIZWlnaHQnLCBnZXRQb3MoZHJhZ2dlZC5zdHlsZS50b3ApKSxcbiAgfVxuICBjdXJyZW50WkluZGV4ICs9IDFcbiAgZHJhZ2dlZC5zdHlsZS56SW5kZXggPSBjdXJyZW50WkluZGV4XG4gIGRyYWdnZWQub2Zmc2V0ID0ge1xuICAgIGxlZnQ6IGV2LmNsaWVudFggLSBwaXhlbHNGcm9tUGVyY2VudCgnV2lkdGgnLCBnZXRQb3MoZHJhZ2dlZC5zdHlsZS5sZWZ0KSksXG4gICAgdG9wOiBldi5jbGllbnRZIC0gcGl4ZWxzRnJvbVBlcmNlbnQoJ0hlaWdodCcsIGdldFBvcyhkcmFnZ2VkLnN0eWxlLnRvcCkpLFxuICB9XG4gIGRyYWdnZWQuc3R5bGUub3BhY2l0eSA9IDAuOFxuXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG1vdXNlbW92ZSlcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIGRyb3ApXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgZHJvcElmT3V0T2ZCb3VuZHMpXG59XG5cbmNvbnN0IGRyb3AgPSAoKSA9PiB7XG4gIGlmICghZHJhZ2dlZCkge1xuICAgIHJldHVyblxuICB9XG5cbiAgZm9yRWFjaChkcmFnZ2FibGVzLCBmdW5jdGlvbihlbGUpIHtcbiAgICBjbC5ybShlbGUsICdkcm9wcGVkJylcbiAgICBjbC5ybShlbGUsICdkcmFnZ2VkJylcbiAgfSlcbiAgY2wuYWRkKGRyYWdnZWQsICdkcm9wcGVkJylcblxuICBkcmFnZ2VkLnN0eWxlLm9wYWNpdHkgPSAxXG5cblxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBtb3VzZW1vdmUpXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBkcm9wKVxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGRyb3BJZk91dE9mQm91bmRzKVxuXG4gIGRyYWdnZWQgPSBmYWxzZVxuICBzdGFydFBvcyA9IGZhbHNlXG59XG5cbmNvbnN0IGRyb3BJZk91dE9mQm91bmRzID0gZSA9PiB7XG4gIGlmIChpc091dE9mQm91bmRzKGUpKSB7XG4gICAgZHJvcChlKVxuICB9XG59XG5cbmNvbnN0IG1vdXNlbW92ZSA9IGV2ID0+IHtcbiAgaWYgKGRyYWdnZWQpIHtcbiAgICBjb25zdCBtYXggPSB7XG4gICAgICBsZWZ0OiB3aW5kb3cuaW5uZXJXaWR0aCAtIGRyYWdnZWQuY2xpZW50V2lkdGgsXG4gICAgICB0b3A6IHdpbmRvdy5pbm5lckhlaWdodCAtIGRyYWdnZWQuY2xpZW50SGVpZ2h0LFxuICAgIH1cblxuICAgIGxldCBuZXdMZWZ0ID0gZXYuY2xpZW50WCAtIGRyYWdnZWQub2Zmc2V0LmxlZnRcbiAgICBpZiAobmV3TGVmdCA8IDApIHtcbiAgICAgIG5ld0xlZnQgPSAwXG4gICAgfSBlbHNlIGlmIChuZXdMZWZ0ID4gbWF4LmxlZnQpIHtcbiAgICAgIG5ld0xlZnQgPSBtYXgubGVmdFxuICAgIH1cblxuICAgIGRyYWdnZWQuc3R5bGUubGVmdCA9IGAke3BlcmNlbnRGcm9tUGl4ZWxzKCdXaWR0aCcsIG5ld0xlZnQpfSVgXG5cbiAgICBsZXQgbmV3VG9wID0gZXYuY2xpZW50WSAtIGRyYWdnZWQub2Zmc2V0LnRvcFxuICAgIGlmIChuZXdUb3AgPCAwKSB7XG4gICAgICBuZXdUb3AgPSAwXG4gICAgfSBlbHNlIGlmIChuZXdUb3AgPiBtYXgudG9wKSB7XG4gICAgICBuZXdUb3AgPSBtYXgudG9wXG4gICAgfVxuICAgIGRyYWdnZWQuc3R5bGUudG9wID0gYCR7cGVyY2VudEZyb21QaXhlbHMoJ0hlaWdodCcsIG5ld1RvcCl9JWBcbiAgfVxufVxuXG5jb25zdCBtYWtlRHJhZ2dhYmxlID0gKGVsZSkgPT4ge1xuICBlbGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgZG9Ob3RoaW5nKVxuICBlbGUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZHJhZylcbiAgZWxlLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBlID0+IHtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgZHJhZyhlKVxuICB9KVxufVxuXG5mb3JFYWNoKGRyYWdnYWJsZXMsIG1ha2VEcmFnZ2FibGUpXG5cbi8vIE1lbnVcbmNvbnN0IG1lbnVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCduYXYnKVswXVxuY29uc3QgYWN0aXZlID0gbWVudUNvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdhY3RpdmUnKVswXVxuXG5jb25zdCB0b2dnbGVNZW51ID0gZSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKVxuICBjbC50b2dnbGUobWVudUNvbnRhaW5lciwgJ3Nob3cnKVxuICByZXR1cm4gZmFsc2Vcbn1cblxuaWYgKGFjdGl2ZSkge1xuICBhY3RpdmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVNZW51KVxuICBhY3RpdmUuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGUgPT4ge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICB0b2dnbGVNZW51KGUpXG4gIH0pXG59XG4iXX0=